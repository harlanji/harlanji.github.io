---
layout: post
title: Lighttpd+FastCGI PHP5 Is Faster Than Apache2+mod_php5
date: 2006-07-30
comments: false
---

<h1>{{ page.title }}</h1>
<div class='post'>
Today I was benchmarking my upcoming PhpFaces code and was thoroughly impressed by the numbers returned by apachebench; until I started testing concurrency, that is. I tested a simple phpinfo() call with various levels of concurrency and was shocked to see that the problem may not be my code, but some bottleneck within either apache, php, or hardware. To test easy things (http server) first, I decided to benchmark using lighttpd, which I use on my local workstation. My perception of lighttpd+fastcgi has always been that since it's CGI it is slow--that's what they taught us, right? Well, FastCGI works differently than normal CGI, but <a href="http://en.wikipedia.org/wiki/Fastcgi">wikipedia</a> says it better than I can :).<br /><br />To cut straight to the numbers:<br /><br /><table border="1" bordercolor="#000000" cellpadding="4" cellspacing="0" width="100%">  <col width="43*">  <col width="43*">  <col width="43*">  <col width="43*">  <col width="43*">  <col width="43*">  <thead>   <tr valign="top">    <th width="17%">     <p>Server</p>    </th>    <th width="17%">     <p>What?</p>    </th>    <th width="17%">     <p># of Requests</p>    </th>    <th width="17%">     <p>Concurrency</p>    </th>    <th width="17%">     <p>Min Time</p>    </th>    <th width="17%">     <p>Max Time</p>    </th>   </tr>  </thead>  <tbody>   <tr valign="top">    <td width="17%">     <p>Apache</p>    </td>    <td width="17%">     <p>phpinfo()</p>    </td>    <td width="17%">     <p>500</p>    </td>    <td width="17%">     <p>500</p>    </td>    <td width="17%">     <p>776</p>    </td>    <td width="17%">     <p>904</p>    </td>   </tr>   <tr valign="top">    <td width="17%">     <p>Lighttpd</p>    </td>    <td width="17%">     <p>-</p>    </td>    <td width="17%">     <p>-</p>    </td>    <td width="17%">     <p>-</p>    </td>    <td width="17%">     <p>377</p>    </td>    <td width="17%">     <p>429</p>    </td>   </tr>   <tr valign="top">    <td width="17%">     <p>Apache</p>    </td>    <td width="17%">     <p>PhpFaces</p>    </td>    <td width="17%">     <p>500</p>    </td>    <td width="17%">     <p>500</p>    </td>    <td width="17%">     <p>12517</p>    </td>    <td width="17%">     <p>40226</p>    </td>   </tr>   <tr valign="top">    <td width="17%">     <p>Lighttpd</p>    </td>    <td width="17%">     <p>-</p>    </td>    <td width="17%">     <p>-</p>    </td>    <td width="17%">     <p>-</p>    </td>    <td width="17%">     <p>1844</p>    </td>    <td width="17%">     <p>9957</p>    </td>   </tr>   <tr valign="top">    <td width="17%">     <p>Apache</p>    </td>    <td width="17%">     <p>PhpFaces (realistic)</p>    </td>    <td width="17%">     <p>150<br /></p>    </td>    <td width="17%">     <p>25<br /></p>    </td>    <td width="17%">     <p>1802</p>    </td>    <td width="17%">     <p>4060</p>    </td>   </tr>   <tr valign="top">    <td width="17%">     <p>Lighttpd</p>    </td>    <td width="17%">     <p>-</p>    </td>    <td width="17%">     <p>-</p>    </td>    <td width="17%">     <p>-</p>    </td>    <td width="17%">     <p>1595</p>    </td>    <td width="17%">     <p>2824</p>    </td>   </tr>  </tbody> </table><br />Complete apachebench output + server specs can be found <a href="http://rosehill.homedns.org/phpfaces/benchmarks.txt">here </a>(self hosted, may not always be available).<br /><br />I must say that I was taken completely by surprise by these results. While Lighttpd may not be the best for all sites, for the vast majority of sites that are either self-hosted or otherwise on dedicated installation of apache it is a shining winner. Lighttpd has all the basic functionality of apache including mod_rewrite, mod_alias, mod_redirect, mod_auth and mod_cgi/fastcgi. There are many others including mod_proxy, but I have yet to experiment with that. More information about Lighttpd can be found at their website, <a href="http://www.lighttpd.net/">here</a>.</div>
