---
layout: post
title: EJB3 Entity Callbacks for Password Fields
date: 2006-10-09
comments: false
---

<h1>{{ page.title }}</h1>
<div class='post'>
After about an hour of pounding my head over how I can automatically encode a stored password after it has been modified I came up with what I think is a pretty clever solution (though hopefully not the best, let me know if you know a better one that doesn't involve stored procedures!):<br /><br /><span style="font-family:courier new;">@Entity<br />public class Member {<br />  Integer id;<br />  String username;<br />  String password;<br />...<br />  transient boolean hasPasswordChanged;<br /><br />  @PrePersist void beforeInsert() {<br />      if( hasPasswordChanged ) {<br />          password = encode( password );<br />          hasPasswordChanged = false;<br />      }<br />  }<br />   public void setPassword(String password) {<br />       hasPasswordChanged = true;<br />       this.password = password;<br />   }<br /></span>...<br />}<br /><br />The function tagged with the PrePersist annotation is called before the entity manager persists an entity to the data source. This is the ideal time to perform operations like this. The 'transient' field simply means that the value will not be serialized or persisted to the database.</div>
