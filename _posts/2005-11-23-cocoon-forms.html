---
layout: post
title: Cocoon Forms
date: 2005-11-23
comments: false
---

<h1>{{ page.title }}</h1>
<div class='post'>
Here is a small writeup on CForms usage. Again, nothing that can't be found in the documentation, just for personal reference:<br /><br />First create a flowscript that loads the Form resource:<br /><span style="font-family:courier new;">cocoon.load("resource://org/apache/cocoon/forms/flow/javascript/Form.js");</span><br /><br />Next create a function that creates an instance of the Form class with a form descriptor as a constructor argument.<br /><span style="font-family:courier new;">var form = new Form("registration.form.xml");</span><br /><br />Now you will call showForm on your form instance and pass a display pipeline as a parameter. CForms will loop within the showForm function until the form validates (as per the form descriptor above):<br /><span style="font-family:courier new;">form.showForm("registration-display-pipeline");</span><br /><br />The display pipeline needs to have cform template code within it, typically namespace ft (http://apache.org/cocoon/forms/1.0#template); the form-template element with a continuation-id element within. It will also have cform instance code within it, typically having a namespace fi (http://apache.org/cocoon/forms/1.0#instance).<br /><span style="font-family:courier new;">&lt;ft:form-template action="continue" method="POST"&gt;</span><br /><span style="font-family:courier new;">    &lt;ft:continuation-id/&gt;</span><br /><span style="font-family:courier new;">    &lt;fi:group&gt;</span><br /><br />The form action continue is caught by the pipeline, simply:<br /><span style="font-family:courier new;">&lt;map:match pattern="continue"&gt;</span><br /><span style="font-family:courier new;">    &lt;map:call continuation="{request-param:continuation-id}"/&gt;</span><br /><span style="font-family:courier new;">&lt;/map:match&gt;</span><br /><br />The display pipeline needs to have the forms transformer applied to it. It should come before any of your GUI or i18n transformations (correct me if I'm wrong here) and obviously after the generate output described above.<br /><span style="font-family:courier new;">&lt;map:transform type="forms"/&gt;</span><br /><br />Finally you can do as you wish with the form model within Flowscript and send the user to a result page with the form model as a parameter:<br /><span style="font-family:courier new;">    var model = form.getModel();</span><br /><span style="font-family:courier new;">    var bizdata = { "username" : model.name }</span><br /><span style="font-family:courier new;">    cocoon.sendPage("registration-success-pipeline.jx", bizdata);</span><br /><br />The success pipeline simply generates a jx file that takes "username" as a parameter.</div>
